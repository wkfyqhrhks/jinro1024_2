<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ì§„ë¡œ ê´€ì‹¬ì‚¬ ì„¤ë¬¸ì¡°ì‚¬</title>

<!-- Pretendard (ê°€ë…ì„± ì¢‹ì€ í•œêµ­ì–´ í°íŠ¸) -->
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://cdn.jsdelivr.net/npm/pretendard/dist/web/static/pretendard.css" rel="stylesheet">

<!-- html2canvas (JPEG ì €ì¥) -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
  :root{
    --bg-grad: linear-gradient(135deg,#6a73ff 0%, #b15cff 50%, #ff4fa2 100%);
    --card: #ffffff;
    --muted: #6b7280;
    --text: #0f172a;
    --accent: #7c3aed;
    --round: 18px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:Pretendard, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "Microsoft YaHei", sans-serif;
    color:var(--text);
    background: var(--bg-grad) fixed;
    background-attachment: fixed;
  }
  .container{
    max-width: 980px;
    margin: 0 auto;
    padding: clamp(16px,3vw,28px);
  }
  .intro, .survey, .results{
    display:none;
  }
  .show{display:block}
  .card{
    background:var(--card);
    border-radius: calc(var(--round) + 6px);
    box-shadow: 0 12px 38px rgba(16,24,40,.12);
    padding: clamp(16px,3vw,28px);
  }
  .btn{
    display:inline-flex; align-items:center; justify-content:center;
    gap:.6rem; font-weight:700;
    background: linear-gradient(90deg,#7c3aed,#ec4899);
    color:#fff; padding:.95rem 1.35rem;
    border-radius:999px; border:0; cursor:pointer;
    box-shadow:0 8px 24px rgba(124,58,237,.35);
    transition: transform .08s ease, filter .1s ease;
  }
  .btn:active{ transform: translateY(1px); filter:brightness(.98) }
  .btn.secondary{background:#f3f4f6; color:#374151; box-shadow:none}
  .title{
    font-size: clamp(22px, 3.4vw, 40px);
    font-weight: 800;
    margin: 0 0 .25rem;
  }
  .subtitle{color:var(--muted); margin:0 0 1.2rem; font-size:clamp(14px,2.2vw,18px)}
  .grid{display:grid; gap:clamp(12px,1.8vw,16px)}
  .grid.cols-2{grid-template-columns:1fr}
  @media (min-width: 840px){
    .grid.cols-2{grid-template-columns:1fr 1fr}
  }
  .pill{
    display:inline-flex; align-items:center; gap:.4rem;
    padding:.35rem .75rem; border-radius:999px;
    background:#eef2ff; color:#4338ca; font-weight:700; font-size:14px;
  }
  .badge{
    width:64px;height:64px;border-radius:16px;display:grid;place-items:center;
    color:#fff;font-weight:800;font-size:28px;
    filter: drop-shadow(0 6px 18px rgba(16,24,40,.20));
  }
  .b-orange{background:#f59e0b}
  .b-green{background:#10b981}
  .b-purple{background:#8b5cf6}
  .muted{color:var(--muted)}
  ul.clean{padding-left:1.2rem; margin:.4rem 0}
  ul.clean li{margin:.35rem 0}
  .row{display:flex; align-items:center; justify-content:space-between; gap:12px}
  .chip{background:#f8fafc;border-radius:999px;padding:.55rem .9rem;font-weight:700}
  .bar{height:12px;border-radius:999px;background:#e5e7eb;overflow:hidden}
  .bar>i{display:block;height:100%}
  .score-row{display:flex;align-items:center;gap:10px}
  .label{min-width:110px}
  .center{text-align:center}
  /* ìº¡ì²˜(ì €ì¥) ë˜í¼: í° ë°°ê²½ + ì—¬ë°± */
  .capture-wrap{
    background:#fff;
    border-radius: calc(var(--round) + 8px);
    padding: clamp(16px,2.2vw,24px);
  }
  /* ê²°ê³¼ í—¤ë”ì˜ ì§ì—…êµ° ì´ë¯¸ì§€ */
  .job-img{
    width:64px;height:64px;border-radius:14px;object-fit:cover;border:1px solid #eef2ff;
    background:#fff; box-shadow:0 8px 22px rgba(16,24,40,.10)
  }
</style>
</head>
<body>

<div class="container">

  <!-- ì¸íŠ¸ë¡œ -->
  <section id="intro" class="intro show">
    <div class="card">
      <div class="title">ì§„ë¡œ ê´€ì‹¬ì‚¬ ì„¤ë¬¸ì¡°ì‚¬</div>
      <p class="subtitle">ë‹¹ì‹ ì˜ ë¯¸ë˜ë¥¼ ìœ„í•œ ì²« ê±¸ìŒ</p>

      <div class="card" style="background:linear-gradient(180deg,#faf5ff,#fdf2f8); border-radius:16px;">
        <h3 style="margin:.2rem 0 1rem; font-size:18px;">ğŸ“ ì„¤ë¬¸ ì•ˆë‚´</h3>
        <ul class="clean">
          <li>ì´ <b>36ê°œ</b> ë¬¸í•­ì— ë‹µë³€í•´ì£¼ì„¸ìš”.</li>
          <li>ê° ë¬¸í•­ì€ <b>1~5ì </b>ìœ¼ë¡œ í‰ê°€í•©ë‹ˆë‹¤.</li>
          <li>ì†”ì§í•œ ë‹µë³€ì´ ê°€ì¥ ì •í™•í•œ ê²°ê³¼ë¥¼ ë§Œë“­ë‹ˆë‹¤.</li>
        </ul>
      </div>

      <div class="center" style="margin-top:16px">
        <button class="btn" id="startBtn">ì„¤ë¬¸ ì‹œì‘í•˜ê¸° â†’</button>
      </div>
    </div>
  </section>

  <!-- ì„¤ë¬¸ (ìƒ˜í”Œ: ì‹¤ì œ ì„¤ë¬¸ í™”ë©´ì€ ê¸°ì¡´ êµ¬í˜„ê³¼ ë™ì¼í•˜ê²Œ ë¶™ì—¬ ì“°ì‹œë©´ ë©ë‹ˆë‹¤) -->
  <section id="survey" class="survey">
    <div class="card center">
      <div class="title">ì„¤ë¬¸ ì§„í–‰ í™”ë©´</div>
      <p class="subtitle">ì—¬ê¸°ì— ê¸°ì¡´ ì„¤ë¬¸ UIë¥¼ ê·¸ëŒ€ë¡œ ë°°ì¹˜í•˜ì„¸ìš”.</p>
      <button class="btn" id="fakeFinish">ê²°ê³¼ ë³´ê¸°(ë°ëª¨)</button>
      <p class="muted" style="margin-top:10px">â€» ì‹¤ì œ ì—°ë™ ì‹œ ê¸°ì¡´ ì„¤ë¬¸ ì™„ë£Œ ì‹œì ì—ì„œ <code>showResults(demoResults)</code> í˜¸ì¶œ</p>
    </div>
  </section>

  <!-- ê²°ê³¼ -->
  <section id="results" class="results">
    <!-- ìº¡ì²˜(ì €ì¥) ëŒ€ìƒ: ì´ ë˜í¼ ê¸°ì¤€ìœ¼ë¡œ JPEG ì €ì¥ë¨ -->
    <div id="captureTarget" class="capture-wrap">
      <div class="card" style="margin-bottom:16px">
        <div class="row">
          <div>
            <div class="title" style="display:flex;align-items:center; gap:.5rem">
              <span>ê²€ì‚¬ ì™„ë£Œ!</span>
            </div>
            <p class="subtitle">ë‹¹ì‹ ë§Œì˜ í¥ë¯¸ ì½”ë“œë¥¼ ë°œê²¬í–ˆì–´ìš”.</p>
          </div>
          <!-- ì§ì—…êµ° ì¹´ë“œ(Top3) -->
          <div class="row" style="gap:10px">
            <div class="badge b-purple">A</div>
            <div class="badge b-orange">E</div>
            <div class="badge b-green">S</div>
          </div>
        </div>
      </div>

      <div class="grid cols-2">
        <!-- ì¶”ì²œ ì§„ë¡œ + ì§ì—…êµ° ì´ë¯¸ì§€ -->
        <div class="card">
          <div class="row">
            <span class="pill">ğŸ¯ ì¶”ì²œ ì§„ë¡œ</span>
            <img id="jobImg" class="job-img" src="assets/IA.png" alt="ì§ì—…êµ° ì´ë¯¸ì§€" />
          </div>
          <h2 id="careerTitle" style="margin:.6rem 0 1rem">ë¸Œëœë“œ ë§ˆì¼€í„°/ì¸í”Œë£¨ì–¸ì„œ</h2>

          <h3 style="margin:.2rem 0 8px;">ğŸ’¼ ê´€ë ¨ ì§ì—…</h3>
          <div id="jobList" class="grid" style="grid-template-columns:1fr 1fr">
            <!-- JSë¡œ ì±„ì›Œì§ -->
          </div>
        </div>

        <!-- í•„ìš” ì—­ëŸ‰ + ë¡œë“œë§µ -->
        <div class="card">
          <div class="grid">
            <div>
              <h3 style="margin:.2rem 0 8px;">âš¡ í•„ìš” ì—­ëŸ‰</h3>
              <ul id="skillList" class="clean"></ul>
            </div>
            <div>
              <h3 style="margin:.2rem 0 8px;">ğŸ—ºï¸ ì§„ë¡œ ë¡œë“œë§µ</h3>
              <ul id="roadmapList" class="clean"></ul>
            </div>
          </div>
        </div>
      </div>

      <!-- ìœ í˜•ë³„ ì ìˆ˜ -->
      <div class="card" style="margin-top:16px">
        <h3 style="margin:.2rem 0 14px;">ğŸ“Š ìœ í˜•ë³„ ì ìˆ˜</h3>
        <div id="scoreList" class="grid"></div>
      </div>
    </div>

    <!-- ì €ì¥ ë²„íŠ¼ -->
    <div class="center" style="margin-top:16px">
      <button class="btn" id="saveJpegBtn">ê²°ê³¼ë¥¼ JPEGë¡œ ì €ì¥</button>
      <button class="btn secondary" id="restartBtn">ë‹¤ì‹œ ì‹œì‘</button>
    </div>
  </section>
</div>

<script>
/* ------------------ ê°„ë‹¨í•œ í™”ë©´ ì „í™˜ ------------------ */
const $ = (s) => document.querySelector(s);
const show = (id) => {
  ['intro','survey','results'].forEach(k => $('#'+k).classList.remove('show'));
  $('#'+id).classList.add('show');
};
$('#startBtn').addEventListener('click', () => show('survey'));
$('#restartBtn')?.addEventListener('click', () => show('intro'));

/* ------------------ ë°ëª¨ ê²°ê³¼(ì‹¤ì œ ì„¤ë¬¸ ê²°ê³¼ë¡œ ë°”ê¿”ì„œ showResults í˜¸ì¶œ) ------------------ */
const demoResults = {
  // ìƒìœ„ 2ê°œ ì¡°í•© ì½”ë“œ
  code: 'AE',
  // ì¶”ì²œ ì§„ë¡œ
  career: {
    title: 'ë¸Œëœë“œ ë§ˆì¼€í„°/ì¸í”Œë£¨ì–¸ì„œ',
    jobs: ['ë””ì§€í„¸ ë§ˆì¼€í„°','ë¸Œëœë“œ ë§¤ë‹ˆì €','ì½˜í…ì¸  ê¸°íšì','SNS ì „ëµê°€'],
    skills: ['ì°½ì˜ì„±','ì»¤ë®¤ë‹ˆì¼€ì´ì…˜','íŠ¸ë Œë“œ ë¶„ì„'],
    roadmap: [
      'ê³ ë“±í•™êµ ë‹¨ê³„ â€” í™”ì‘, ì‹¬ë¦¬, ì‚¬íšŒë¬¸í™”',
      'ëŒ€í•™ ë‹¨ê³„ â€” ê´‘ê³ í™ë³´, ë¬¸í™”ì½˜í…ì¸ , ë§ˆì¼€íŒ…',
      'ê²½í—˜ ë° í™œë™ â€” SNS ìš´ì˜, ì¸í„´ì‹­, ë¸Œëœë”© í”„ë¡œì íŠ¸'
    ]
  },
  // 6ìœ í˜• ì ìˆ˜ (í¼ì„¼íŠ¸)
  scores: [
    { key:'A', name:'ì˜ˆìˆ í˜• (A)', color:'#ec4899', value:37 },
    { key:'E', name:'ì§„ì·¨í˜• (E)', color:'#f59e0b', value:33 },
    { key:'S', name:'ì‚¬íšŒí˜• (S)', color:'#10b981', value:23 },
    { key:'R', name:'ì‹¤ì¬í˜• (R)', color:'#60a5fa', value:20 },
    { key:'I', name:'íƒêµ¬í˜• (I)', color:'#a78bfa', value:27 },
    { key:'C', name:'ê´€ìŠµí˜• (C)', color:'#22c55e', value:20 }
  ],
};
$('#fakeFinish').addEventListener('click', () => showResults(demoResults));

/* ------------------ ê²°ê³¼ ë Œë”ë§ ------------------ */
function showResults(res){
  // ì¶”ì²œ ì§„ë¡œ
  $('#careerTitle').textContent = res.career.title;

  // ê´€ë ¨ ì§ì—…
  const jobList = $('#jobList');
  jobList.innerHTML = '';
  res.career.jobs.forEach(j=>{
    const div = document.createElement('div');
    div.className = 'chip';
    div.textContent = j;
    jobList.appendChild(div);
  });

  // í•„ìš” ì—­ëŸ‰
  const skillList = $('#skillList');
  skillList.innerHTML = '';
  res.career.skills.forEach(s=>{
    const li = document.createElement('li');
    li.textContent = s;
    skillList.appendChild(li);
  });

  // ë¡œë“œë§µ
  const roadmapList = $('#roadmapList');
  roadmapList.innerHTML = '';
  res.career.roadmap.forEach(r=>{
    const li = document.createElement('li');
    li.textContent = r;
    roadmapList.appendChild(li);
  });

  // íƒ€ì… ë°°ì§€(ìƒë‹¨ 3ê°œ) â€” ì´ë¯¸ ë°°ì¹˜ëŠ” ë˜ì–´ ìˆìœ¼ë‚˜ ê°’ ë°”ê¾¸ê³  ì‹¶ìœ¼ë©´ ì—¬ê¸°ì„œ ë³€ê²½ ê°€ëŠ¥

  // ì ìˆ˜ ë°”
  const scoreList = $('#scoreList');
  scoreList.innerHTML = '';
  res.scores.forEach(sc=>{
    const row = document.createElement('div');
    row.className = 'score-row';
    row.innerHTML = `
      <div class="label"><b>${sc.name}</b></div>
      <div class="bar" style="flex:1"><i style="width:${sc.value}%; background:${sc.color}"></i></div>
      <div style="width:46px;text-align:right"><b>${sc.value}%</b></div>
    `;
    scoreList.appendChild(row);
  });

  // ì§ì—…êµ° ì´ë¯¸ì§€ (assets/XX.png). ì½”ë“œ ì¡°í•©ì´ ì—†ê±°ë‚˜ íŒŒì¼ì´ ì—†ìœ¼ë©´ IA.png í´ë°±
  const jobImg = $('#jobImg');
  const primary = (res.code || 'IA').toUpperCase().replace(/[^A-Z]/g,'');
  const imgPathCandidate = `assets/${primary}.png`;
  jobImg.src = imgPathCandidate;
  jobImg.onerror = () => { jobImg.src = 'assets/IA.png'; };

  show('results');
}

/* ------------------ iOS ê°ì§€ ------------------ */
function isIOS(){
  return /iPad|iPhone|iPod/.test(navigator.userAgent) || 
         (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
}

/* ------------------ JPEG ì €ì¥ ------------------ */
async function saveAsJPEG(){
  const node = document.getElementById('captureTarget');

  // ìº¡ì²˜ ì˜µì…˜: í° ë°°ê²½ + ì„ ëª…ë„ í–¥ìƒ
  const canvas = await html2canvas(node, {
    backgroundColor: '#ffffff',
    scale: Math.min(window.devicePixelRatio || 1, 2), // ê³¼ë„í•œ ìš©ëŸ‰ ë°©ì§€
    useCORS: true,
    allowTaint: true
  });

  const mime = 'image/jpeg';
  const quality = 0.92;
  const dataUrl = canvas.toDataURL(mime, quality);

  if(isIOS()){
    // iOS Safari: download ë¶ˆê°€ â†’ ìƒˆ íƒ­ì— ì—´ì–´ ê¸¸ê²Œ ëˆŒëŸ¬ ì €ì¥
    const w = window.open();
    if(w){
      w.document.write(`<html><head><title>ê²°ê³¼ ì €ì¥</title></head>
        <body style="margin:0;background:#fff;display:grid;place-items:center;">
        <img src="${dataUrl}" style="max-width:100%;height:auto"/>
        <p style="font:14px/1.4 Pretendard,sans-serif;color:#444;margin:12px">
          ì´ë¯¸ì§€ë¥¼ ê¸¸ê²Œ ëˆŒëŸ¬ â€œì‚¬ì§„ì— ì €ì¥â€ì„ ì„ íƒí•˜ì„¸ìš”.
        </p>
        </body></html>`);
      w.document.close();
    }else{
      alert('íŒì—…ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤. ì£¼ì†Œì°½ ì˜¤ë¥¸ìª½ì—ì„œ íŒì—… í—ˆìš© í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
    }
  }else{
    // ë°ìŠ¤í¬í†±/ì•ˆë“œ: ì§ì ‘ ë‹¤ìš´ë¡œë“œ
    const a = document.createElement('a');
    a.href = dataUrl;
    a.download = 'career-result.jpg';
    document.body.appendChild(a);
    a.click();
    a.remove();
  }
}
document.getElementById('saveJpegBtn').addEventListener('click', saveAsJPEG);
</script>

</body>
</html>
