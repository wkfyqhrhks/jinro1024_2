<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>ì§„ë¡œ ê´€ì‹¬ì‚¬ ì„¤ë¬¸ì¡°ì‚¬</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" defer></script>
<style>
  :root{
    --bg1:#6c63ff; --bg2:#ff4db6;
    --card:#ffffff; --ink:#111827; --muted:#6b7280;
    --brand:#7c3aed; --brand2:#ec4899; --ok:#10b981; --chip:#f3f4f6;
    --pad: clamp(16px, 3.5vw, 28px);
  }
  html,body{height:100%}
  body{
    margin:0; font-family:Pretendard,system-ui,-apple-system,Segoe UI,Roboto,Arial,Apple SD Gothic Neo,"Noto Sans KR",sans-serif; color:var(--ink);
    background: linear-gradient(135deg, #6a65ff 0%, #a35cff 40%, #db52ff 70%, #ff52a8 100%);
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }
  .wrap{min-height:100dvh; display:flex; align-items:center; justify-content:center; padding:24px}
  .container{width:100%; max-width:980px}
  .card{
    background:var(--card); border-radius:24px; box-shadow:0 10px 30px rgba(0,0,0,.14);
    padding:var(--pad); overflow:hidden;
  }
  h1{font-size:clamp(24px,4.5vw,40px); margin:0 0 8px}
  .lead{color:var(--muted); margin:0 0 18px; font-size:clamp(14px,2.2vw,18px)}
  .notice{background:linear-gradient(180deg,#fafafa,#f4f5ff); border-radius:18px; padding:18px 20px; margin-top:12px}
  .notice li{margin:.45rem 0}
  .btn{
    display:inline-flex; align-items:center; justify-content:center; gap:.5rem;
    padding:14px 22px; border-radius:999px; font-weight:700; border:0; cursor:pointer;
    color:#fff; background:linear-gradient(90deg,var(--brand),var(--brand2));
    box-shadow:0 6px 18px rgba(124,58,237,.35);
  }
  .btn:disabled{opacity:.4; cursor:not-allowed}
  .center{display:flex; justify-content:center; margin-top:14px}

  /* ì„¤ë¬¸/ê²°ê³¼ ê³µìš© */
  .progress{height:10px; background:#e5e7eb; border-radius:999px; overflow:hidden; margin:8px 0 20px}
  .bar{height:100%; background:linear-gradient(90deg,var(--brand),var(--brand2)); width:0%}

  .grid{display:grid; gap:12px}
  @media (min-width:840px){ .grid.cols-2{grid-template-columns:1fr 1fr} }

  .chip{display:inline-flex; align-items:center; gap:6px; font-weight:700; color:#111;
    background:#f3f4f6; border-radius:16px; padding:6px 10px; font-size:14px}
  .badge{display:inline-grid; place-items:center; width:64px; height:64px; border-radius:16px; color:#fff; font-weight:900}
  .badge.e{background:#f97316} .badge.c{background:#14b8a6} .badge.i{background:#8b5cf6}
  .badge.r{background:#3b82f6} .badge.a{background:#ec4899} .badge.s{background:#22c55e}

  /* ê²°ê³¼ ì¹´ë“œ */
  #resultCard{background:#fff; border-radius:22px; padding:var(--pad); }
  .result-row{display:flex; align-items:center; gap:14px}
  .job-illust{
    width:72px; height:72px; border-radius:16px; object-fit:cover; flex:0 0 auto;
    background:#f3f4f6; border:1px solid #eef0f5;
  }
  .sub{color:var(--muted); font-weight:700; margin:8px 0 6px}

  /* ì €ì¥ ì•ˆë‚´ */
  .save-hint{color:#374151; font-size:13px; margin-top:8px}

  /* ìº¡ì²˜ ì—¬ë°±ì„ ìœ„í•´ ê°ì‹¸ëŠ” ë°•ìŠ¤ */
  .capture-wrap{
    background:#fff; border-radius:22px;
    padding:32px; /* <- ì €ì¥ ì´ë¯¸ì§€ì˜ 'ì—¬ë°±' */
  }
  /* ëª¨ë°”ì¼ì—ì„œë„ ì§ì—… ì´ë¯¸ì§€ ê°•ì œ í‘œì‹œ */
  .result-hero{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
  .result-hero h2{margin:0; font-size:clamp(20px,3.6vw,28px)}
</style>
</head>
<body>
<div class="wrap">
  <div class="container">
    <!-- ì¸íŠ¸ë¡œ -->
    <div class="card" id="intro">
      <h1>ì§„ë¡œ ê´€ì‹¬ì‚¬ ì„¤ë¬¸ì¡°ì‚¬</h1>
      <p class="lead">ë‹¹ì‹ ì˜ ë¯¸ë˜ë¥¼ ìœ„í•œ ì²« ê±¸ìŒ</p>
      <div class="notice">
        <strong>ğŸ“‹ ì„¤ë¬¸ ì•ˆë‚´</strong>
        <ul>
          <li>ì´ <b>36ê°œ</b> ë¬¸í•­ì— ë‹µë³€í•´ì£¼ì„¸ìš”.</li>
          <li>ê° ë¬¸í•­ì€ <b>1~5ì </b>ìœ¼ë¡œ í‰ê°€í•©ë‹ˆë‹¤.</li>
          <li>ì†”ì§í•œ ë‹µë³€ì´ ê°€ì¥ ì •í™•í•œ ê²°ê³¼ë¥¼ ë§Œë“­ë‹ˆë‹¤.</li>
        </ul>
      </div>
      <div class="center">
        <button class="btn" id="startBtn">ì„¤ë¬¸ ì‹œì‘í•˜ê¸° â†’</button>
      </div>
    </div>

    <!-- ì„¤ë¬¸ (ë°ëª¨ë¡œ ì§„í–‰ë¥ ë§Œ ë³´ì—¬ì¤Œ) -->
    <div class="card" id="survey" style="display:none">
      <div class="result-hero">
        <span class="chip">ë¬¸í•­ 1 / 36</span>
        <span class="chip">ì‘ë‹µ 0ê°œ</span>
      </div>
      <div class="progress"><div class="bar" id="pb" style="width:6%"></div></div>
      <p class="lead">â€» ì‹¤ì œ ì„¤ë¬¸ UIëŠ” ê¸°ì¡´ êµ¬í˜„ì„ ì‚¬ìš©í•˜ì„¸ìš”. ì´ ìƒ˜í”Œì€ ê²°ê³¼ ìº¡ì²˜ ë™ì‘ ê²€ì¦ìš©ì…ë‹ˆë‹¤.</p>
      <div class="center">
        <button class="btn" id="toResult">ê²°ê³¼ í˜ì´ì§€ë¡œ ì˜ˆì‹œ ì´ë™</button>
      </div>
    </div>

    <!-- ê²°ê³¼ -->
    <div class="capture-wrap" id="captureWrap" style="display:none">
      <div id="resultCard">
        <div class="result-hero" style="margin-bottom:10px">
          <div class="chip">ğŸ† ê²€ì‚¬ ì™„ë£Œ</div>
          <h2>ë‹¹ì‹ ë§Œì˜ í¥ë¯¸ ì½”ë“œë¥¼ ë°œê²¬í–ˆì–´ìš”!</h2>
        </div>

        <!-- Top3 ë±ƒì§€ -->
        <div class="card" style="background:#f8fafc; margin:10px 0 18px">
          <div class="sub">ë‚˜ì˜ í¥ë¯¸ ì½”ë“œ Top3</div>
          <div style="display:flex; gap:10px; flex-wrap:wrap">
            <div class="badge a">A</div>
            <div class="badge e">E</div>
            <div class="badge s">S</div>
          </div>
        </div>

        <!-- ì¶”ì²œ ì§„ë¡œ + ì§ì—… ì´ë¯¸ì§€ (ëª¨ë°”ì¼/ë°ìŠ¤í¬í†± ëª¨ë‘ í‘œì‹œ) -->
        <div class="card" style="background:#f8fafc; margin:10px 0 18px">
          <div class="result-row">
            <!-- âš ï¸ ê²°ê³¼ ì½”ë“œì— ë§ì¶° srcë§Œ ë°”ê¿”ì£¼ì„¸ìš” (IA, IE, RI, IS, IC, AE, SE, EC, RC, RA, SC, AC, â€¦) -->
            <img id="careerImage" class="job-illust" src="assets/IA.png" alt="ì§ì—…êµ° ì´ë¯¸ì§€" />
            <div>
              <span class="chip">ğŸ¯ ì¶”ì²œ ì§„ë¡œ</span>
              <h3 style="margin:.4rem 0 0">ë¸Œëœë“œ ë§ˆì¼€í„°/ì¸í”Œë£¨ì–¸ì„œ</h3>
            </div>
          </div>

          <div class="grid cols-2" style="margin-top:14px">
            <div class="card" style="background:#fff">
              <div class="sub">ğŸ’¼ ê´€ë ¨ ì§ì—…</div>
              <div style="display:grid; gap:8px">
                <div class="chip">ë””ì§€í„¸ ë§ˆì¼€í„°</div>
                <div class="chip">ë¸Œëœë“œ ë§¤ë‹ˆì €</div>
                <div class="chip">ì½˜í…ì¸  ê¸°íšì</div>
                <div class="chip">SNS ì „ëµê°€</div>
              </div>
            </div>
            <div class="card" style="background:#fff">
              <div class="sub">âš¡ í•„ìš” ì—­ëŸ‰</div>
              <ul style="margin:8px 0 0 18px; padding:0">
                <li>ì°½ì˜ì„±</li>
                <li>ì»¤ë®¤ë‹ˆì¼€ì´ì…˜</li>
                <li>íŠ¸ë Œë“œ ë¶„ì„</li>
              </ul>
              <div class="sub" style="margin-top:14px">ğŸ—ºï¸ ì§„ë¡œ ë¡œë“œë§µ</div>
              <ol style="margin:8px 0 0 18px; padding:0">
                <li>ê³ ë“±í•™êµ ë‹¨ê³„ â€” í™”ì‘, ì‹¬ë¦¬, ì‚¬íšŒë¬¸í™”</li>
                <li>ëŒ€í•™ ë‹¨ê³„ â€” ê´‘ê³ í™ë³´, ë¬¸í™”ì½˜í…ì¸ , ë§ˆì¼€íŒ…</li>
                <li>ê²½í—˜ ë° í™œë™ â€” SNS ìš´ì˜, ì¸í„´ì‹­, ë¸Œëœë”© í”„ë¡œì íŠ¸</li>
              </ol>
            </div>
          </div>
        </div>

        <!-- ìœ í˜•ë³„ ì ìˆ˜ ë°” -->
        <div class="card" style="background:#f8fafc">
          <div class="sub">ìœ í˜•ë³„ ì ìˆ˜</div>
          <div style="display:grid; gap:10px">
            <!-- ë§‰ëŒ€ëŠ” widthë§Œ ë³€ê²½í•´ì„œ ì‚¬ìš© -->
            <div>
              <div style="display:flex; justify-content:space-between; font-weight:700"><span>ì˜ˆìˆ í˜• (A)</span><span>37%</span></div>
              <div class="progress" style="height:12px"><div class="bar" style="width:37%"></div></div>
            </div>
            <div>
              <div style="display:flex; justify-content:space-between; font-weight:700"><span>ì§„ì·¨í˜• (E)</span><span>33%</span></div>
              <div class="progress" style="height:12px"><div class="bar" style="width:33%"></div></div>
            </div>
            <div>
              <div style="display:flex; justify-content:space-between; font-weight:700"><span>ì‚¬íšŒí˜• (S)</span><span>23%</span></div>
              <div class="progress" style="height:12px"><div class="bar" style="width:23%"></div></div>
            </div>
            <div>
              <div style="display:flex; justify-content:space-between; font-weight:700"><span>ì‹¤ì¬í˜• (R)</span><span>20%</span></div>
              <div class="progress" style="height:12px"><div class="bar" style="width:20%"></div></div>
            </div>
            <div>
              <div style="display:flex; justify-content:space-between; font-weight:700"><span>íƒêµ¬í˜• (I)</span><span>27%</span></div>
              <div class="progress" style="height:12px"><div class="bar" style="width:27%"></div></div>
            </div>
            <div>
              <div style="display:flex; justify-content:space-between; font-weight:700"><span>ê´€ìŠµí˜• (C)</span><span>20%</span></div>
              <div class="progress" style="height:12px"><div class="bar" style="width:20%"></div></div>
            </div>
          </div>
        </div>
      </div>

      <!-- ì €ì¥ ë²„íŠ¼/ì•ˆë‚´ -->
      <div class="center" style="gap:8px; margin-top:12px">
        <button class="btn" id="saveJpegBtn">ê²°ê³¼ë¥¼ JPEGë¡œ ì €ì¥</button>
      </div>
      <div class="center"><div class="save-hint" id="saveHint" aria-live="polite"></div></div>
    </div>
  </div>
</div>

<script>
  // í™”ë©´ ì „í™˜ (ë°ëª¨)
  const intro = document.getElementById('intro');
  const survey = document.getElementById('survey');
  const captureWrap = document.getElementById('captureWrap');
  document.getElementById('startBtn').addEventListener('click', ()=>{
    intro.style.display='none'; survey.style.display='block';
  });
  document.getElementById('toResult').addEventListener('click', ()=>{
    survey.style.display='none'; captureWrap.style.display='block';
  });

  /**
   * ê²°ê³¼ ìº¡ì²˜ â†’ JPEG ë‹¤ìš´ë¡œë“œ (iOS ì‚¬íŒŒë¦¬ í´ë°± í¬í•¨)
   * - í•˜ì–€ ìº”ë²„ìŠ¤ì— 'ì—¬ë°±'ì„ ë”í•´ ê·¸ë ¤ì„œ í…Œë‘ë¦¬ê°€ ê½‰ ì°¨ì§€ ì•ŠìŒ
   * - iOSì—ì„œ a[download] ë¶ˆê°€ì‹œ: ìƒˆ íƒ­ìœ¼ë¡œ ì—´ì–´ "ê¸¸ê²Œ ëˆŒëŸ¬ ì´ë¯¸ì§€ ì €ì¥" ìœ ë„
   */
  const saveBtn = document.getElementById('saveJpegBtn');
  const hint = document.getElementById('saveHint');

  function isiOS(){
    return /iP(ad|hone|od)/.test(navigator.userAgent);
  }
  function timeStamp(){
    const d=new Date(); const p=n=>String(n).padStart(2,'0');
    return `${d.getFullYear()}${p(d.getMonth()+1)}${p(d.getDate())}_${p(d.getHours())}${p(d.getMinutes())}`;
  }

  async function saveAsJpeg(){
    const target = document.getElementById('resultCard');

    // html2canvas ì˜µì…˜: ìŠ¤ì¼€ì¼ ë†’ê²Œ, ë°°ê²½ í°ìƒ‰
    const canvas = await html2canvas(target, {
      backgroundColor:'#ffffff',
      scale: window.devicePixelRatio > 1 ? 2 : 1.5,
      useCORS: true
    });

    // ì—¬ë°±(í”½ì…€)
    const margin = 32; // â† í•„ìš”ì‹œ 24~48ë¡œ ì¡°ì ˆ
    const out = document.createElement('canvas');
    out.width  = canvas.width  + margin*2;
    out.height = canvas.height + margin*2;

    const ctx = out.getContext('2d');
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0,0,out.width,out.height);
    ctx.drawImage(canvas, margin, margin);

    // iOSì—ì„œ download ì†ì„± ë™ì‘ ë¬¸ì œ ëŒ€ë¹„: toBlob + ë‹¤ìš´ë¡œë“œ/í´ë°± ì²˜ë¦¬
    out.toBlob(async (blob)=>{
      const fname = `career-result_${timeStamp()}.jpg`;

      // Web Share(ì´ë¯¸ì§€) ê°€ëŠ¥í•˜ë©´ ìš°ì„  ì œê³µ
      if (navigator.canShare && navigator.canShare({files:[new File([blob], fname, {type:'image/jpeg'})]})) {
        try{
          await navigator.share({ files:[new File([blob], fname, {type:'image/jpeg'})], title:'ì§„ë¡œ ê²°ê³¼ ì €ì¥' });
          hint.textContent = 'ê³µìœ ë¡œ ì €ì¥ì´ ì™„ë£Œë˜ì—ˆì–´ìš”.';
          return;
        }catch(e){ /* ì‚¬ìš©ìê°€ ì·¨ì†Œí•œ ê²½ìš° ë“±ì€ ë¬´ì‹œ */ }
      }

      // ì¼ë°˜ ë‹¤ìš´ë¡œë“œ ì‹œë„
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = fname;

      // iOS ì‚¬íŒŒë¦¬ í´ë°±: ìƒˆ íƒ­ìœ¼ë¡œ ì—´ê¸° (ê¸¸ê²Œ ëˆŒëŸ¬ ì €ì¥)
      if (isiOS()) {
        window.open(url, '_blank');
        hint.textContent = 'ìƒˆ íƒ­ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì—´ì—ˆì–´ìš”. ê¸¸ê²Œ ëˆŒëŸ¬ "ì‚¬ì§„ì— ì €ì¥"ì„ ì„ íƒí•˜ì„¸ìš”.';
        setTimeout(()=>URL.revokeObjectURL(url), 30000);
        return;
      }

      // ë°ìŠ¤í¬í†±/ì•ˆë“œ ì•ˆë“œë¡œì´ë“œ ë“± ëŒ€ë¶€ë¶„ ë¸Œë¼ìš°ì €
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      hint.textContent = 'JPEG íŒŒì¼ ë‹¤ìš´ë¡œë“œë¥¼ ì‹œì‘í–ˆì–´ìš”.';
    }, 'image/jpeg', 0.92);
  }

  saveBtn.addEventListener('click', ()=>{
    hint.textContent = 'ì´ë¯¸ì§€ë¥¼ ì¤€ë¹„ ì¤‘â€¦';
    saveAsJpeg().catch(()=>{
      hint.textContent = 'ì €ì¥ì´ ì‹¤íŒ¨í–ˆì–´ìš”. ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ í™•ì¸í•œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
    });
  });

  // ì˜ˆì‹œ: ì¶”ì²œ ì§„ë¡œ ì½”ë“œì— ë§ì¶° ì´ë¯¸ì§€ ê²½ë¡œ ë°”ê¾¸ê¸° (ì‹¤ì œ ê²°ê³¼ ê³„ì‚° í›„ í˜¸ì¶œ)
  function setCareerImageByCode(code){ // e.g. 'IA','IE','EC' ...
    const img = document.getElementById('careerImage');
    img.src = `assets/${code}.png`;
    img.onerror = ()=>{ img.src='assets/IA.png'; }; // ì—†ìœ¼ë©´ ê¸°ë³¸ ì´ë¯¸ì§€
  }
  // ë°ëª¨ìš©: ì´ˆê¸°ì— IA.pngë¡œ í‘œì‹œ (ë°ìŠ¤í¬í†±/ëª¨ë°”ì¼ ëª¨ë‘ ë…¸ì¶œë¨)
  setCareerImageByCode('IA');
</script>
</body>
</html>
