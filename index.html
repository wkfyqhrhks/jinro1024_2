<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>진로 관심사 설문 (RIASEC)</title>
<meta name="color-scheme" content="light only" />
<style>
  :root{
    --grad1:#6d72ff; --grad2:#c055ff; --grad3:#ff4fa0;
    --ink:#111827; --muted:#6b7280; --ring:#7c3aed;
  }
  html,body{ height:100%; }
  body{
    margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans KR',sans-serif;
    background: linear-gradient(135deg,var(--grad1) 0%, var(--grad2) 50%, var(--grad3) 100%);
    -webkit-font-smoothing:antialiased;
  }
  .page{ padding: 28px 0 56px; }
  .container{
    max-width: 980px; width: 100%; margin: 0 auto; padding: 20px;
    background: #fff; border-radius: 24px; box-shadow: 0 20px 42px rgba(0,0,0,.08);
  }

  /* Intro */
  .intro-header{ display:flex; gap:16px; align-items:center; }
  .intro-title{ font-size: clamp(24px,3.6vw,38px); font-weight: 800; margin: 0; color: var(--ink); }
  .intro-sub{ color:var(--muted) }
  .intro-note{
    margin-top:16px; padding:16px; border-radius:16px;
    background: linear-gradient(180deg, #f7f3ff, #fdf2fb);
  }
  .intro-actions{ display:flex; justify-content:center; margin-top:22px; }
  .btn-start{
    display:block; padding:14px 24px; border-radius:9999px; border:0; cursor:pointer;
    background:linear-gradient(90deg,#7c3aed,#ec4899); color:#fff; font-weight:700;
    box-shadow: 0 12px 20px rgba(124,58,237,.18);
  }

  /* Survey */
  .q-head{ display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
  .bar{ height:10px; background:#e5e7eb; border-radius:9999px; overflow:hidden; }
  .bar > i{ display:block; height:100%; width:0%; background:linear-gradient(90deg,#7c3aed,#ec4899); }
  .q-card{ background:#fff; border-radius: 20px; padding: 20px; box-shadow: 0 8px 24px rgba(0,0,0,.06); }
  .q-type{ display:inline-block; padding:6px 12px; border-radius:9999px; color:#fff; font-weight:800; font-size:12px; margin-bottom:8px }
  .q-emoji{ font-size:48px; margin: 10px 0; }
  .q-text{ font-size: clamp(18px,2.4vw,24px); font-weight:800; color:var(--ink); }
  .q-role{ color:var(--muted); font-style: italic; }
  .options{ display:grid; gap:10px; margin-top: 16px; }
  .opt{ padding:14px; border-radius:14px; background:#f3f4f6; border:0; text-align:left; font-weight:700; cursor:pointer; }
  .opt.is-selected{ color:#fff; background:linear-gradient(90deg,#10b981,#06b6d4); box-shadow: 0 8px 18px rgba(16,185,129,.22); }
  .navs{ display:flex; justify-content:space-between; margin-top: 16px; gap: 10px; }
  .btn{ padding:11px 16px; border-radius:9999px; border:0; font-weight:800; cursor:pointer; }
  .btn-next{ background:linear-gradient(90deg,#7c3aed,#ec4899); color:#fff; }
  .btn-prev{ background:#eef2ff; color:#3730a3; }
  .btn:disabled{ opacity:.5; cursor:not-allowed }

  /* Results */
  .result-head{ text-align:center; margin-bottom:12px }
  .result-title{ font-size: clamp(22px,3.2vw,32px); font-weight:900; margin:6px 0 2px; }
  .result-sub{ color:var(--muted) }
  .career-img{
    width:100%; max-width:520px; display:block; margin: 12px auto 0;
    border-radius:16px; box-shadow: 0 10px 24px rgba(0,0,0,.08); background:#fff;
  }
  .save-wrap{ text-align:center; margin-top:16px }
  .btn-save{ padding:12px 18px; border-radius:9999px; border:0; font-weight:800; cursor:pointer; background:#111827; color:#fff; }

  /* pills for type */
  .c-R{ background:#3b82f6 } .c-I{ background:#8b5cf6 } .c-A{ background:#ec4899 }
  .c-S{ background:#10b981 } .c-E{ background:#f59e0b } .c-C{ background:#14b8a6 }

  @media (max-width:480px){
    .container{ padding:16px; border-radius: 18px; }
    .btn-start{ width:100%; max-width: 360px; }
  }
</style>
</head>
<body>

<!-- INTRO -->
<section id="page-intro" class="page">
  <div class="container">
    <div class="intro-header">
      <div style="font-size:36px">✨</div>
      <div>
        <h1 class="intro-title">진로 관심사 설문조사</h1>
        <div class="intro-sub">당신의 미래를 위한 첫 걸음</div>
      </div>
    </div>

    <div class="intro-note">
      <strong>📝 설문 안내</strong>
      <ul style="margin:10px 0 0 18px; color:#374151; line-height:1.6">
        <li>총 <b>36개</b> 문항에 답변해주세요.</li>
        <li>각 문항은 <b>1~5점</b>으로 평가합니다.</li>
        <li>솔직한 답변이 가장 정확한 결과를 만듭니다.</li>
      </ul>
    </div>

    <div class="intro-actions">
      <button id="startBtn" class="btn-start">설문 시작하기 →</button>
    </div>
  </div>
</section>

<!-- SURVEY -->
<section id="page-survey" class="page" hidden>
  <div class="container">
    <div class="q-head">
      <div id="q-count" style="font-weight:800;color:#6d28d9">문항 1 / 36</div>
      <div style="color:#7c3aed;font-weight:800"><span id="q-progress">0</span>%</div>
    </div>
    <div class="bar" aria-hidden="true"><i id="barFill"></i></div>

    <div class="q-card" style="margin-top:14px">
      <span id="q-type" class="q-type c-R">실재형 (R)</span>
      <div class="q-emoji" id="q-emoji">⚙️</div>
      <div class="q-text" id="q-text">문항 텍스트</div>
      <div class="q-role" id="q-role">💼 캐릭터</div>

      <div class="options" id="q-options"></div>

      <div class="navs">
        <button id="btnPrev" class="btn btn-prev">← 이전</button>
        <button id="btnNext" class="btn btn-next">다음 →</button>
      </div>
      <div id="warn" style="display:none;margin-top:10px;color:#92400e;background:#fef3c7;border:1px solid #fde68a;border-radius:10px;padding:8px 10px">모든 문항에 답해주세요.</div>
    </div>
  </div>
</section>

<!-- RESULTS -->
<section id="page-results" class="page" hidden>
  <div class="container" id="resultCard">
    <div class="result-head">
      <div style="font-size:28px">🏆</div>
      <h2 class="result-title">검사 완료!</h2>
      <div class="result-sub">당신만의 흥미 코드를 발견했어요</div>
    </div>

    <!-- 코드 이미지 -->
    <img id="careerImg" alt="추천 직업군 이미지" class="career-img" />

    <div style="margin-top:14px;display:grid;gap:10px">
      <div id="myTypes" style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap"></div>

      <div id="careerTitle" style="font-size:20px;font-weight:800;text-align:center;margin-top:6px"></div>
      <div id="careerJobs" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px"></div>

      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px">
        <div style="background:#fff7ed;border-left:4px solid #f59e0b;border-radius:12px;padding:12px">
          <div style="font-weight:800;margin-bottom:6px">⚡ 핵심 역량</div>
          <ul id="careerSkills" style="margin:0 0 0 18px;padding:0"></ul>
        </div>
        <div style="background:#ecfdf5;border-left:4px solid #10b981;border-radius:12px;padding:12px">
          <div style="font-weight:800;margin-bottom:6px">📈 5년 후 전망</div>
          <div id="careerGrowth" style="font-size:34px;font-weight:900;color:#059669">+0%</div>
          <div class="bar"><i id="growthBar" style="background:linear-gradient(90deg,#10b981,#34d399)"></i></div>
        </div>
      </div>

      <div style="background:#eff6ff;border-left:4px solid #3b82f6;border-radius:12px;padding:12px">
        <div style="font-weight:800;margin-bottom:6px">🗺️ 진로 로드맵</div>
        <ol id="careerRoadmap" style="margin:0 0 0 18px;padding:0;line-height:1.7"></ol>
      </div>
    </div>
  </div>

  <div class="save-wrap">
    <button id="btnSave" class="btn-save">결과를 JPG로 저장</button>
    <button id="btnRestart" class="btn btn-prev" style="margin-left:8px">처음으로</button>
  </div>
</section>

<!-- html2canvas for JPG download -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" integrity="sha256-UY3mF6p5P8m9eM0c3/6u6o4h0kGdPqk8B6Q7z8hEJpE=" crossorigin="anonymous"></script>

<script>
/* -------------------- 데이터 -------------------- */
const TYPE = {
  R:{name:'실재형', pill:'c-R'}, I:{name:'탐구형', pill:'c-I'}, A:{name:'예술형', pill:'c-A'},
  S:{name:'사회형', pill:'c-S'}, E:{name:'진취형', pill:'c-E'}, C:{name:'관습형', pill:'c-C'}
};

const questions = [
  // R
  { id:1,  type:'R', text:'3D 프린터나 로봇과 같은 기계를 조작하여 결과물을 만드는 활동에 흥미를 느낀다.', emoji:'⚙️', role:'미래 엔지니어' },
  { id:2,  type:'R', text:'직접 몸을 움직여 야외에서 식물을 기르거나 동물을 돌보는 활동을 즐긴다.', emoji:'🌱', role:'바이오 전문가' },
  { id:3,  type:'R', text:'복잡하게 얽힌 전선이나 기계 장치의 문제를 찾아내고 수리하는 일에 몰두한다.', emoji:'🔧', role:'유지보수 기술자' },
  { id:4,  type:'R', text:'실제 건축물이나 인테리어 모형을 설계하고 제작하는 작업이 재미있다.', emoji:'🏗️', role:'스마트 건설가' },
  { id:5,  type:'R', text:'보안·소방·응급구조 등 신체 활동이 요구되는 일에 도전하고 싶다.', emoji:'🚨', role:'안전 요원' },
  { id:6,  type:'R', text:'VR 장비로 기계 작동 시뮬레이션을 경험하는 것이 좋다.', emoji:'🥽', role:'VR 트레이너' },
  // I
  { id:7,  type:'I', text:'데이터나 통계에서 규칙을 찾아내는 일에 흥미가 있다.', emoji:'📊', role:'빅데이터 분석가' },
  { id:8,  type:'I', text:'심리·뇌과학 등 복잡한 원리를 깊이 연구하고 싶다.', emoji:'🧠', role:'인지 과학자' },
  { id:9,  type:'I', text:'실험과 가설 검증을 통해 지식을 발견하는 것이 즐겁다.', emoji:'🔬', role:'연구원' },
  { id:10, type:'I', text:'AI 알고리즘의 오류 원인을 논리적으로 파헤치는 것을 좋아한다.', emoji:'🤖', role:'AI 디버거' },
  { id:11, type:'I', text:'미래 사회 변화나 우주 등 미지의 영역에 질문을 던진다.', emoji:'🔭', role:'미래학자' },
  { id:12, type:'I', text:'논리 게임이나 추리로 정보를 조합해 결론을 도출하는 활동을 좋아한다.', emoji:'🔍', role:'논리학자' },
  // A
  { id:13, type:'A', text:'그림·음악·글쓰기 등으로 생각과 감정을 표현하길 좋아한다.', emoji:'🎨', role:'멀티 아티스트' },
  { id:14, type:'A', text:'디지털 드로잉·미디어 아트 등 테크 예술에 관심이 많다.', emoji:'💻', role:'미디어 아티스트' },
  { id:15, type:'A', text:'영상 편집·웹툰·게임 스토리 등 문화 콘텐츠 제작을 하고 싶다.', emoji:'🎬', role:'콘텐츠 크리에이터' },
  { id:16, type:'A', text:'공연·패션·공간 디자인 등 미적 작업에 매력을 느낀다.', emoji:'✨', role:'디자이너' },
  { id:17, type:'A', text:'자유롭고 개성 있는 작업 환경을 선호한다.', emoji:'🦋', role:'자유 영혼' },
  { id:18, type:'A', text:'대중에 감동을 주는 창작물을 만드는 것이 목표다.', emoji:'🎭', role:'감성 전달자' },
  // S
  { id:19, type:'S', text:'도움이 필요한 사람을 돕고 문제 해결할 때 보람을 느낀다.', emoji:'🤝', role:'사회 봉사자' },
  { id:20, type:'S', text:'사람들의 고민을 듣고 정서적 지지를 해주는 역할이 편안하다.', emoji:'💬', role:'심리 상담가' },
  { id:21, type:'S', text:'새 지식·기술을 재미있게 가르치는 방법을 연구한다.', emoji:'📚', role:'교육 코치' },
  { id:22, type:'S', text:'보건·의료에서 건강과 회복을 돕는 일을 하고 싶다.', emoji:'⚕️', role:'헬스케어 전문가' },
  { id:23, type:'S', text:'다양한 문화권과 협력하여 공동 목표를 달성하는 활동이 좋다.', emoji:'🌍', role:'글로벌 협력가' },
  { id:24, type:'S', text:'온라인 커뮤니티 운영·갈등 조정 역할을 즐긴다.', emoji:'💻', role:'커뮤니티 매니저' },
  // E
  { id:25, type:'E', text:'새 사업 아이디어를 기획하고 설득하는 일을 잘한다.', emoji:'💡', role:'스타트업 CEO' },
  { id:26, type:'E', text:'팀 리더로 동기를 부여하고 이끄는 것을 좋아한다.', emoji:'👑', role:'카리스마 리더' },
  { id:27, type:'E', text:'금융·투자 등 경제적 가치를 창출하는 활동에 관심이 많다.', emoji:'💰', role:'핀테크 전문가' },
  { id:28, type:'E', text:'발표·연설에 자신감이 있으며 설득력을 높이려 노력한다.', emoji:'🎤', role:'협상가' },
  { id:29, type:'E', text:'글로벌 트렌드를 읽고 새로운 비즈니스 기회를 찾고 싶다.', emoji:'🌐', role:'국제 비즈니스맨' },
  { id:30, type:'E', text:'개인 브랜딩·SNS로 영향력을 키우는 활동을 즐긴다.', emoji:'📱', role:'인플루언서' },
  // C
  { id:31, type:'C', text:'서류·DB를 분류/관리하는 일에 능숙하다.', emoji:'🗂️', role:'정보 관리자' },
  { id:32, type:'C', text:'규칙·절차에 따라 완벽히 처리할 때 안정감을 느낀다.', emoji:'✅', role:'행정 전문가' },
  { id:33, type:'C', text:'예산·재무 등 수치를 다루는 일이 좋다.', emoji:'💵', role:'회계사' },
  { id:34, type:'C', text:'보안·개인정보 등 시스템 안전을 지키는 일에 책임감을 느낀다.', emoji:'🔒', role:'보안 전문가' },
  { id:35, type:'C', text:'문서·보고서 등 정보를 깔끔하게 정리한다.', emoji:'📋', role:'기획 비서' },
  { id:36, type:'C', text:'자동화 도구로 업무 효율을 높이는 방법을 찾는다.', emoji:'⚡', role:'업무 효율화 전문가' },
];

const careerPaths = {
  IA:{ title:'AI 기반 콘텐츠 크리에이터',
      jobs:['데이터 시각화 디자이너','UX 리서처','미디어 아티스트','AI 아트 디렉터'],
      roadmap:{ high:'미술, 정보, 미디어 교과 선택', college:'융합디자인, 데이터사이언스, 미디어 커뮤니케이션 전공', experience:'UI/UX 공모전, 포트폴리오, 디자인씽킹' },
      skills:['창의적 문제해결','데이터 리터러시','디자인 사고'], growth:85 },
  IE:{ title:'AI 스타트업 전략가',
      jobs:['AI 기획자','테크 PM','비즈니스 애널리스트','디지털 컨설턴트'],
      roadmap:{ high:'수학, 인공지능 기초, 경제', college:'경영정보, 컴공, 산업공학', experience:'창업 동아리, BM 프로젝트, 해커톤' },
      skills:['논리적 사고','비즈니스 감각','데이터 분석'], growth:92 },
  AE:{ title:'브랜드 마케터/인플루언서',
      jobs:['디지털 마케터','브랜드 매니저','콘텐츠 기획자','SNS 전략가'],
      roadmap:{ high:'화작, 심리, 사회문화', college:'광고홍보, 문화콘텐츠, 마케팅', experience:'SNS 운영, 마케팅 인턴, 브랜딩 프로젝트' },
      skills:['창의성','커뮤니케이션','트렌드 분석'], growth:78 },
  SE:{ title:'소셜 임팩트 리더',
      jobs:['사회적기업가','CSR 매니저','비영리 기획자','임팩트 투자'],
      roadmap:{ high:'사회문화, 윤리, 경제', college:'사회복지, 경영, 국제개발', experience:'봉사 리딩, 사회혁신 캠프, 크라우드펀딩' },
      skills:['공감 능력','리더십','문제해결력'], growth:73 },
  RI:{ title:'첨단 기술 연구자',
      jobs:['로봇공학자','IoT 개발자','바이오 엔지니어','우주항공 기술자'],
      roadmap:{ high:'물리, 화학, 정보', college:'기계, 전자, 생명공학', experience:'과학 동아리, 발명, 연구 프로젝트' },
      skills:['기술적 이해','실험 설계','논리적 사고'], growth:88 },
  RS:{ title:'헬스케어 기술 전문가',
      jobs:['의료기기 엔지니어','재활 치료사','스포츠 트레이너','응급구조사'],
      roadmap:{ high:'생명과학, 체육, 보건', college:'의공학, 물리치료, 응급구조', experience:'의료 봉사, 응급처치 자격, 재활 실습' },
      skills:['신체 활동성','공감 능력','위기 대응'], growth:81 },
  IS:{ title:'인간 중심 연구자',
      jobs:['심리학자','교육 연구원','인지과학자','UX 리서처'],
      roadmap:{ high:'심리, 사회문화, 생명과학', college:'심리, 교육, 인지과학', experience:'상담 봉사, 연구 보조, 사용자 조사' },
      skills:['분석력','공감 능력','연구 설계'], growth:76 },
  IC:{ title:'데이터 사이언티스트',
      jobs:['빅데이터 분석가','AI 엔지니어','정보보안 연구원','퀀트 애널리스트'],
      roadmap:{ high:'수학, 정보, 통계', college:'통계, 컴공, 데이터사이언스', experience:'데분 공모전, 코딩 부트캠프, 오픈소스' },
      skills:['데이터 분석','프로그래밍','논리적 사고'], growth:95 },
  AS:{ title:'힐링 콘텐츠 크리에이터',
      jobs:['음악 치료사','예술 치료사','문화기획자','커뮤니티 아티스트'],
      roadmap:{ high:'음악, 미술, 심리', college:'예술치료, 문화예술교육, 상담심리', experience:'예술 봉사, 프로그램 보조, 커뮤니티 프로젝트' },
      skills:['창의성','공감 능력','감성 표현'], growth:71 },
  AC:{ title:'디지털 아카이브 전문가',
      jobs:['큐레이터','디지털 아키비스트','콘텐츠 매니저','박물관 전문가'],
      roadmap:{ high:'미술, 역사, 정보', college:'문헌정보, 박물관학, 문화재학', experience:'전시 기획, 아카이빙, 문화재 답사' },
      skills:['창의성','체계적 사고','디지털 리터러시'], growth:68 },
  SC:{ title:'행정 서비스 전문가',
      jobs:['공무원','인사 담당자','행정사','비서'],
      roadmap:{ high:'사회문화, 정치와 법, 경제', college:'행정, 경영, 법학', experience:'학생회, 행정 인턴, 공모전' },
      skills:['조직력','공감 능력','업무 처리'], growth:65 },
  EC:{ title:'금융 전략가',
      jobs:['재무 분석가','투자 상담사','회계사','세무사'],
      roadmap:{ high:'경제, 수학, 정보', college:'경영, 회계, 금융', experience:'모의 투자, 자격증, 금융 인턴' },
      skills:['리더십','수리 능력','재무 분석'], growth:82 },
  RA:{ title:'메이커 크리에이터',
      jobs:['제품 디자이너','3D 모델러','건축가','인테리어 디자이너'],
      roadmap:{ high:'미술, 기술가정, 물리', college:'산업디자인, 건축, 실내디자인', experience:'메이커 동아리, 디자인 공모전, 3D 프린팅' },
      skills:['기술적 능력','창의성','공간 감각'], growth:79 },
  RC:{ title:'스마트 시스템 운영자',
      jobs:['설비 관리자','품질 관리자','생산 관리자','시스템 엔지니어'],
      roadmap:{ high:'기술가정, 정보, 수학', college:'산업공학, 기계, 전기', experience:'현장 실습, 자격증, 자동화 프로젝트' },
      skills:['기술적 능력','체계적 사고','품질 관리'], growth:74 },
  RE:{ title:'현장 리더',
      jobs:['건설 현장 감독','물류 관리자','안전 관리자','스포츠 에이전트'],
      roadmap:{ high:'체육, 기술가정, 경영', college:'건설공학, 물류학, 안전공학', experience:'현장 실습, 안전 교육, 프로젝트 관리' },
      skills:['신체 활동성','리더십','위기 관리'], growth:72 },
};

const knownCodes = Object.keys(careerPaths);

/* -------------------- 상태 -------------------- */
const answers = {};
let idx = 0;

/* -------------------- 유틸 -------------------- */
const $ = s => document.querySelector(s);

function showPage(which){
  $('#page-intro').hidden   = (which!=='intro');
  $('#page-survey').hidden  = (which!=='survey');
  $('#page-results').hidden = (which!=='results');
  window.scrollTo({top:0, behavior:'instant'});
}

function renderQuestion(){
  const q = questions[idx];
  $('#q-count').textContent = `문항 ${idx+1} / ${questions.length}`;
  const pct = Math.round(((idx+1)/questions.length)*100);
  $('#q-progress').textContent = pct;
  $('#barFill').style.width = pct + '%';

  $('#q-type').className = `q-type ${TYPE[q.type].pill}`;
  $('#q-type').textContent = `${TYPE[q.type].name} (${q.type})`;
  $('#q-emoji').textContent = q.emoji;
  $('#q-text').textContent  = q.text;
  $('#q-role').textContent  = '💼 ' + q.role;

  const opts = [
    {v:5, label:'매우 그렇다'},
    {v:4, label:'그렇다'},
    {v:3, label:'보통이다'},
    {v:2, label:'그렇지 않다'},
    {v:1, label:'전혀 그렇지 않다'},
  ];
  const wrap = $('#q-options'); wrap.innerHTML='';
  opts.forEach(o=>{
    const b = document.createElement('button');
    b.className = 'opt' + (answers[q.id]===o.v? ' is-selected':'');
    b.textContent = `${o.label} (${o.v})`;
    b.onclick = ()=>{ answers[q.id]=o.v; renderQuestion(); };
    wrap.appendChild(b);
  });

  $('#btnPrev').disabled = (idx===0);
  $('#btnNext').textContent = (idx===questions.length-1) ? '결과 보기 ✨' : '다음 →';
}

function calcResults(){
  const scores = {R:0,I:0,A:0,S:0,E:0,C:0};
  questions.forEach(q=>{ if(answers[q.id]) scores[q.type]+=answers[q.id]; });
  const sorted = Object.entries(scores).sort((a,b)=>b[1]-a[1])
                  .map(([type,score])=>({type,score,percentage:(score/30)*100}));
  const top = sorted.slice(0,3);
  let code = top[0].type + top[1].type;
  if(!knownCodes.includes(code)){
    const rev = code.split('').reverse().join('');
    code = knownCodes.includes(rev) ? rev : 'IA';
  }
  return {sorted, top, code};
}

function bindResults(res){
  // 코드 뱃지
  const badgeWrap = $('#myTypes'); badgeWrap.innerHTML='';
  res.top.forEach((t,i)=>{
    const el = document.createElement('div');
    el.style.cssText='display:flex;align-items:center;gap:6px;background:#f3f4f6;border-radius:9999px;padding:6px 10px';
    el.innerHTML = `<span class="${TYPE[t.type].pill}" style="display:inline-block;color:#fff;font-weight:900;padding:4px 10px;border-radius:9999px">${t.type}</span>
                    <b>${TYPE[t.type].name}</b>
                    <span style="color:#6b7280">${Math.round(t.percentage)}%</span>`;
    badgeWrap.appendChild(el);
  });

  // 이미지
  setCareerImage(res.code);

  // 본문
  const career = careerPaths[res.code];
  $('#careerTitle').textContent = `추천 진로: ${career.title}`;

  // 직업군
  const jobsWrap = $('#careerJobs'); jobsWrap.innerHTML='';
  career.jobs.forEach(j=>{
    const d=document.createElement('div');
    d.style.cssText='background:#fff;border:1px solid #eef2ff;border-radius:12px;padding:10px';
    d.textContent = '• ' + j;
    jobsWrap.appendChild(d);
  });

  // 스킬
  const sWrap = $('#careerSkills'); sWrap.innerHTML='';
  career.skills.forEach(s=>{
    const li=document.createElement('li'); li.textContent=s; sWrap.appendChild(li);
  });

  // 성장
  $('#careerGrowth').textContent = `+${career.growth}%`;
  $('#growthBar').style.width = career.growth + '%';

  // 로드맵
  const rm = $('#careerRoadmap'); rm.innerHTML='';
  const order = [career.roadmap.high, career.roadmap.college, career.roadmap.experience];
  ['고등학교 단계','대학 단계','경험 및 활동'].forEach((ttl,i)=>{
    const li=document.createElement('li');
    li.innerHTML = `<b>${i+1}. ${ttl}</b> — ${order[i]}`;
    rm.appendChild(li);
  });
}

function setCareerImage(code){
  const img = $('#careerImg');
  img.src = `./assets/${code}.png?v=${Date.now()}`; // 캐시우회
  img.onerror = ()=>{ img.src = `./assets/IA.png?v=${Date.now()}`; };
}

/* -------------------- 이벤트 -------------------- */
$('#startBtn').addEventListener('click', ()=> showPage('survey'));

$('#btnPrev').addEventListener('click', ()=>{
  if(idx>0){ idx--; renderQuestion(); }
});

$('#btnNext').addEventListener('click', ()=>{
  // 마지막이면 결과
  if(idx === questions.length-1){
    const answered = Object.keys(answers).length;
    if(answered < questions.length){
      $('#warn').style.display='block';
      return;
    }
    const res = calcResults();
    bindResults(res);
    showPage('results');
  }else{
    // 다음
    const q = questions[idx];
    if(!answers[q.id]){ $('#warn').style.display='block'; return; }
    $('#warn').style.display='none';
    idx++; renderQuestion();
  }
});

$('#btnRestart').addEventListener('click', ()=>{
  // reset
  Object.keys(answers).forEach(k=>delete answers[k]);
  idx=0; renderQuestion(); showPage('intro');
});

/* JPG 저장 */
$('#btnSave').addEventListener('click', async ()=>{
  const node = document.getElementById('resultCard');
  // 흰 배경으로 캔버스에 그리기(모바일 검은 배경 방지)
  const canvas = await html2canvas(node, {scale:2, backgroundColor:'#ffffff', useCORS:true});
  const data = canvas.toDataURL('image/jpeg', 0.95);
  const a = document.createElement('a');
  a.href = data;
  a.download = 'riasec-result.jpg';
  document.body.appendChild(a);
  a.click();
  a.remove();
});

/* 초기 렌더 */
renderQuestion();
showPage('intro');
</script>
</body>
</html>
